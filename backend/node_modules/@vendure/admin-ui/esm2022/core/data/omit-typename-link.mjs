import { ApolloLink } from '@apollo/client/core';
import { omit } from '@vendure/common/lib/omit';
/**
 * The "__typename" property added by Apollo Client causes errors when posting the entity
 * back in a mutation. Therefore this link will remove all such keys before the object
 * reaches the API layer.
 *
 * See: https://github.com/apollographql/apollo-client/issues/1913#issuecomment-393721604
 */
export class OmitTypenameLink extends ApolloLink {
    constructor() {
        super((operation, forward) => {
            if (operation.variables) {
                operation.variables = omit(operation.variables, ['__typename'], true);
            }
            return forward ? forward(operation) : null;
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib21pdC10eXBlbmFtZS1saW5rLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9jb3JlL3NyYy9kYXRhL29taXQtdHlwZW5hbWUtbGluay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDakQsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRWhEOzs7Ozs7R0FNRztBQUNILE1BQU0sT0FBTyxnQkFBaUIsU0FBUSxVQUFVO0lBQzVDO1FBQ0ksS0FBSyxDQUFDLENBQUMsU0FBUyxFQUFFLE9BQU8sRUFBRSxFQUFFO1lBQ3pCLElBQUksU0FBUyxDQUFDLFNBQVMsRUFBRTtnQkFDckIsU0FBUyxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRSxDQUFDLFlBQVksQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO2FBQ3pFO1lBRUQsT0FBTyxPQUFPLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBQy9DLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztDQUNKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBvbGxvTGluayB9IGZyb20gJ0BhcG9sbG8vY2xpZW50L2NvcmUnO1xyXG5pbXBvcnQgeyBvbWl0IH0gZnJvbSAnQHZlbmR1cmUvY29tbW9uL2xpYi9vbWl0JztcclxuXHJcbi8qKlxyXG4gKiBUaGUgXCJfX3R5cGVuYW1lXCIgcHJvcGVydHkgYWRkZWQgYnkgQXBvbGxvIENsaWVudCBjYXVzZXMgZXJyb3JzIHdoZW4gcG9zdGluZyB0aGUgZW50aXR5XHJcbiAqIGJhY2sgaW4gYSBtdXRhdGlvbi4gVGhlcmVmb3JlIHRoaXMgbGluayB3aWxsIHJlbW92ZSBhbGwgc3VjaCBrZXlzIGJlZm9yZSB0aGUgb2JqZWN0XHJcbiAqIHJlYWNoZXMgdGhlIEFQSSBsYXllci5cclxuICpcclxuICogU2VlOiBodHRwczovL2dpdGh1Yi5jb20vYXBvbGxvZ3JhcGhxbC9hcG9sbG8tY2xpZW50L2lzc3Vlcy8xOTEzI2lzc3VlY29tbWVudC0zOTM3MjE2MDRcclxuICovXHJcbmV4cG9ydCBjbGFzcyBPbWl0VHlwZW5hbWVMaW5rIGV4dGVuZHMgQXBvbGxvTGluayB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigob3BlcmF0aW9uLCBmb3J3YXJkKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChvcGVyYXRpb24udmFyaWFibGVzKSB7XHJcbiAgICAgICAgICAgICAgICBvcGVyYXRpb24udmFyaWFibGVzID0gb21pdChvcGVyYXRpb24udmFyaWFibGVzLCBbJ19fdHlwZW5hbWUnXSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmb3J3YXJkID8gZm9yd2FyZChvcGVyYXRpb24pIDogbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iXX0=