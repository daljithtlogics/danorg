import { BehaviorSubject } from 'rxjs';
import { map } from 'rxjs/operators';
import { createBaseDetailResolveFn } from '../common/base-detail.component';
import { AngularRouteComponent } from './components/angular-route.component';
import { ROUTE_COMPONENT_OPTIONS } from './components/route.component';
/**
 * @description
 * Registers an Angular standalone component to be rendered in a route.
 *
 * @example
 * ```ts title="routes.ts"
 * import { registerRouteComponent } from '\@vendure/admin-ui/core';
 * import { registerReactRouteComponent } from '\@vendure/admin-ui/react';
 *
 * import { ProductReviewDetailComponent } from './components/product-review-detail/product-review-detail.component';
 * import { AllProductReviewsList } from './components/all-product-reviews-list/all-product-reviews-list.component';
 * import { GetReviewDetailDocument } from './generated-types';
 *
 * export default [
 *     registerRouteComponent({
 *         path: '',
 *         component: AllProductReviewsList,
 *         breadcrumb: 'Product reviews',
 *     }),
 *     registerRouteComponent({
 *         path: ':id',
 *         component: ProductReviewDetailComponent,
 *         query: GetReviewDetailDocument,
 *         entityKey: 'productReview',
 *         getBreadcrumbs: entity => [
 *             {
 *                 label: 'Product reviews',
 *                 link: ['/extensions', 'product-reviews'],
 *             },
 *             {
 *                 label: `#${entity?.id} (${entity?.product.name})`,
 *                 link: [],
 *             },
 *         ],
 *     }),
 * ];
 * ```
 *
 * @docsCategory routes
 */
export function registerRouteComponent(options) {
    const { query, entityKey, variables, getBreadcrumbs } = options;
    const breadcrumbSubject$ = new BehaviorSubject(options.breadcrumb ?? '');
    const titleSubject$ = new BehaviorSubject(options.title);
    const resolveFn = query && entityKey
        ? createBaseDetailResolveFn({
            query,
            entityKey,
            variables,
        })
        : undefined;
    return {
        path: options.path ?? '',
        providers: [
            {
                provide: ROUTE_COMPONENT_OPTIONS,
                useValue: {
                    component: options.component,
                    title$: titleSubject$,
                    breadcrumb$: breadcrumbSubject$,
                },
            },
            ...(options.routeConfig?.providers ?? []),
        ],
        ...(options.routeConfig ?? {}),
        resolve: { ...(resolveFn ? { detail: resolveFn } : {}), ...(options.routeConfig?.resolve ?? {}) },
        data: {
            breadcrumb: breadcrumbSubject$,
            ...(options.routeConfig?.data ?? {}),
            ...(getBreadcrumbs
                ? {
                    breadcrumb: data => data.detail.entity.pipe(map((entity) => getBreadcrumbs(entity))),
                }
                : {}),
            ...(options.routeConfig?.data ?? {}),
        },
        component: AngularRouteComponent,
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXItcm91dGUtY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9jb3JlL3NyYy9leHRlbnNpb24vcmVnaXN0ZXItcm91dGUtY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUlBLE9BQU8sRUFBRSxlQUFlLEVBQWMsTUFBTSxNQUFNLENBQUM7QUFDbkQsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3JDLE9BQU8sRUFBdUIseUJBQXlCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUVqRyxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUM3RSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQTJCdkU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQXVDRztBQUNILE1BQU0sVUFBVSxzQkFBc0IsQ0FNcEMsT0FBc0U7SUFDcEUsTUFBTSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLGNBQWMsRUFBRSxHQUFHLE9BQU8sQ0FBQztJQUVoRSxNQUFNLGtCQUFrQixHQUFHLElBQUksZUFBZSxDQUFrQixPQUFPLENBQUMsVUFBVSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQzFGLE1BQU0sYUFBYSxHQUFHLElBQUksZUFBZSxDQUFxQixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7SUFFN0UsTUFBTSxTQUFTLEdBTVgsS0FBSyxJQUFJLFNBQVM7UUFDZCxDQUFDLENBQUMseUJBQXlCLENBQUM7WUFDdEIsS0FBSztZQUNMLFNBQVM7WUFDVCxTQUFTO1NBQ1osQ0FBQztRQUNKLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFFcEIsT0FBTztRQUNILElBQUksRUFBRSxPQUFPLENBQUMsSUFBSSxJQUFJLEVBQUU7UUFDeEIsU0FBUyxFQUFFO1lBQ1A7Z0JBQ0ksT0FBTyxFQUFFLHVCQUF1QjtnQkFDaEMsUUFBUSxFQUFFO29CQUNOLFNBQVMsRUFBRSxPQUFPLENBQUMsU0FBUztvQkFDNUIsTUFBTSxFQUFFLGFBQWE7b0JBQ3JCLFdBQVcsRUFBRSxrQkFBa0I7aUJBQ0Y7YUFDcEM7WUFDRCxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxTQUFTLElBQUksRUFBRSxDQUFDO1NBQzVDO1FBQ0QsR0FBRyxDQUFDLE9BQU8sQ0FBQyxXQUFXLElBQUksRUFBRSxDQUFDO1FBQzlCLE9BQU8sRUFBRSxFQUFFLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxPQUFPLElBQUksRUFBRSxDQUFDLEVBQUU7UUFDakcsSUFBSSxFQUFFO1lBQ0YsVUFBVSxFQUFFLGtCQUFrQjtZQUM5QixHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDO1lBQ3BDLEdBQUcsQ0FBQyxjQUFjO2dCQUNkLENBQUMsQ0FBQztvQkFDSSxVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FDZixJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBVyxFQUFFLEVBQUUsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztpQkFDNUU7Z0JBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUNULEdBQUcsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUM7U0FDdkM7UUFDRCxTQUFTLEVBQUUscUJBQXFCO0tBQ25CLENBQUM7QUFDdEIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUmVzb2x2ZUZuLCBSb3V0ZSB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcbmltcG9ydCB7IFJlc3VsdE9mLCBUeXBlZERvY3VtZW50Tm9kZSB9IGZyb20gJ0BncmFwaHFsLXR5cGVkLWRvY3VtZW50LW5vZGUvY29yZSc7XHJcbmltcG9ydCB7IERvY3VtZW50Tm9kZSB9IGZyb20gJ2dyYXBocWwnO1xyXG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBCYXNlRGV0YWlsQ29tcG9uZW50LCBjcmVhdGVCYXNlRGV0YWlsUmVzb2x2ZUZuIH0gZnJvbSAnLi4vY29tbW9uL2Jhc2UtZGV0YWlsLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEJyZWFkY3J1bWJWYWx1ZSB9IGZyb20gJy4uL3Byb3ZpZGVycy9icmVhZGNydW1iL2JyZWFkY3J1bWIuc2VydmljZSc7XHJcbmltcG9ydCB7IEFuZ3VsYXJSb3V0ZUNvbXBvbmVudCB9IGZyb20gJy4vY29tcG9uZW50cy9hbmd1bGFyLXJvdXRlLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFJPVVRFX0NPTVBPTkVOVF9PUFRJT05TIH0gZnJvbSAnLi9jb21wb25lbnRzL3JvdXRlLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFJvdXRlQ29tcG9uZW50T3B0aW9ucyB9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBDb25maWd1cmF0aW9uIGZvciBhIHJvdXRlIGNvbXBvbmVudC5cclxuICpcclxuICogQGRvY3NDYXRlZ29yeSByb3V0ZXNcclxuICovXHJcbmV4cG9ydCB0eXBlIFJlZ2lzdGVyUm91dGVDb21wb25lbnRPcHRpb25zPFxyXG4gICAgQ29tcG9uZW50IGV4dGVuZHMgYW55IHwgQmFzZURldGFpbENvbXBvbmVudDxFbnRpdHk+LFxyXG4gICAgRW50aXR5IGV4dGVuZHMgeyBpZDogc3RyaW5nOyB1cGRhdGVkQXQ/OiBzdHJpbmcgfSxcclxuICAgIFQgZXh0ZW5kcyBEb2N1bWVudE5vZGUgfCBUeXBlZERvY3VtZW50Tm9kZTxhbnksIHsgaWQ6IHN0cmluZyB9PixcclxuICAgIEZpZWxkIGV4dGVuZHMga2V5b2YgUmVzdWx0T2Y8VD4sXHJcbiAgICBSIGV4dGVuZHMgRmllbGQsXHJcbj4gPSB7XHJcbiAgICBjb21wb25lbnQ6IFR5cGU8Q29tcG9uZW50PiB8IENvbXBvbmVudDtcclxuICAgIHRpdGxlPzogc3RyaW5nO1xyXG4gICAgYnJlYWRjcnVtYj86IEJyZWFkY3J1bWJWYWx1ZTtcclxuICAgIHBhdGg/OiBzdHJpbmc7XHJcbiAgICBxdWVyeT86IFQ7XHJcbiAgICBnZXRCcmVhZGNydW1icz86IChlbnRpdHk6IEV4Y2x1ZGU8UmVzdWx0T2Y8VD5bUl0sICdRdWVyeSc+KSA9PiBCcmVhZGNydW1iVmFsdWU7XHJcbiAgICBlbnRpdHlLZXk/OiBDb21wb25lbnQgZXh0ZW5kcyBCYXNlRGV0YWlsQ29tcG9uZW50PGFueT4gPyBSIDogdW5kZWZpbmVkO1xyXG4gICAgdmFyaWFibGVzPzogVCBleHRlbmRzIFR5cGVkRG9jdW1lbnROb2RlPGFueSwgaW5mZXIgVj4gPyBPbWl0PFYsICdpZCc+IDogbmV2ZXI7XHJcbiAgICByb3V0ZUNvbmZpZz86IFJvdXRlO1xyXG59ICYgKENvbXBvbmVudCBleHRlbmRzIEJhc2VEZXRhaWxDb21wb25lbnQ8YW55PiA/IHsgZW50aXR5S2V5OiBSIH0gOiB1bmtub3duKTtcclxuXHJcbi8qKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogUmVnaXN0ZXJzIGFuIEFuZ3VsYXIgc3RhbmRhbG9uZSBjb21wb25lbnQgdG8gYmUgcmVuZGVyZWQgaW4gYSByb3V0ZS5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgdHMgdGl0bGU9XCJyb3V0ZXMudHNcIlxyXG4gKiBpbXBvcnQgeyByZWdpc3RlclJvdXRlQ29tcG9uZW50IH0gZnJvbSAnXFxAdmVuZHVyZS9hZG1pbi11aS9jb3JlJztcclxuICogaW1wb3J0IHsgcmVnaXN0ZXJSZWFjdFJvdXRlQ29tcG9uZW50IH0gZnJvbSAnXFxAdmVuZHVyZS9hZG1pbi11aS9yZWFjdCc7XHJcbiAqXHJcbiAqIGltcG9ydCB7IFByb2R1Y3RSZXZpZXdEZXRhaWxDb21wb25lbnQgfSBmcm9tICcuL2NvbXBvbmVudHMvcHJvZHVjdC1yZXZpZXctZGV0YWlsL3Byb2R1Y3QtcmV2aWV3LWRldGFpbC5jb21wb25lbnQnO1xyXG4gKiBpbXBvcnQgeyBBbGxQcm9kdWN0UmV2aWV3c0xpc3QgfSBmcm9tICcuL2NvbXBvbmVudHMvYWxsLXByb2R1Y3QtcmV2aWV3cy1saXN0L2FsbC1wcm9kdWN0LXJldmlld3MtbGlzdC5jb21wb25lbnQnO1xyXG4gKiBpbXBvcnQgeyBHZXRSZXZpZXdEZXRhaWxEb2N1bWVudCB9IGZyb20gJy4vZ2VuZXJhdGVkLXR5cGVzJztcclxuICpcclxuICogZXhwb3J0IGRlZmF1bHQgW1xyXG4gKiAgICAgcmVnaXN0ZXJSb3V0ZUNvbXBvbmVudCh7XHJcbiAqICAgICAgICAgcGF0aDogJycsXHJcbiAqICAgICAgICAgY29tcG9uZW50OiBBbGxQcm9kdWN0UmV2aWV3c0xpc3QsXHJcbiAqICAgICAgICAgYnJlYWRjcnVtYjogJ1Byb2R1Y3QgcmV2aWV3cycsXHJcbiAqICAgICB9KSxcclxuICogICAgIHJlZ2lzdGVyUm91dGVDb21wb25lbnQoe1xyXG4gKiAgICAgICAgIHBhdGg6ICc6aWQnLFxyXG4gKiAgICAgICAgIGNvbXBvbmVudDogUHJvZHVjdFJldmlld0RldGFpbENvbXBvbmVudCxcclxuICogICAgICAgICBxdWVyeTogR2V0UmV2aWV3RGV0YWlsRG9jdW1lbnQsXHJcbiAqICAgICAgICAgZW50aXR5S2V5OiAncHJvZHVjdFJldmlldycsXHJcbiAqICAgICAgICAgZ2V0QnJlYWRjcnVtYnM6IGVudGl0eSA9PiBbXHJcbiAqICAgICAgICAgICAgIHtcclxuICogICAgICAgICAgICAgICAgIGxhYmVsOiAnUHJvZHVjdCByZXZpZXdzJyxcclxuICogICAgICAgICAgICAgICAgIGxpbms6IFsnL2V4dGVuc2lvbnMnLCAncHJvZHVjdC1yZXZpZXdzJ10sXHJcbiAqICAgICAgICAgICAgIH0sXHJcbiAqICAgICAgICAgICAgIHtcclxuICogICAgICAgICAgICAgICAgIGxhYmVsOiBgIyR7ZW50aXR5Py5pZH0gKCR7ZW50aXR5Py5wcm9kdWN0Lm5hbWV9KWAsXHJcbiAqICAgICAgICAgICAgICAgICBsaW5rOiBbXSxcclxuICogICAgICAgICAgICAgfSxcclxuICogICAgICAgICBdLFxyXG4gKiAgICAgfSksXHJcbiAqIF07XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAZG9jc0NhdGVnb3J5IHJvdXRlc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyUm91dGVDb21wb25lbnQ8XHJcbiAgICBDb21wb25lbnQgZXh0ZW5kcyBhbnkgfCBCYXNlRGV0YWlsQ29tcG9uZW50PEVudGl0eT4sXHJcbiAgICBFbnRpdHkgZXh0ZW5kcyB7IGlkOiBzdHJpbmc7IHVwZGF0ZWRBdD86IHN0cmluZyB9LFxyXG4gICAgVCBleHRlbmRzIERvY3VtZW50Tm9kZSB8IFR5cGVkRG9jdW1lbnROb2RlPGFueSwgeyBpZDogc3RyaW5nIH0+LFxyXG4gICAgRmllbGQgZXh0ZW5kcyBrZXlvZiBSZXN1bHRPZjxUPixcclxuICAgIFIgZXh0ZW5kcyBGaWVsZCxcclxuPihvcHRpb25zOiBSZWdpc3RlclJvdXRlQ29tcG9uZW50T3B0aW9uczxDb21wb25lbnQsIEVudGl0eSwgVCwgRmllbGQsIFI+KSB7XHJcbiAgICBjb25zdCB7IHF1ZXJ5LCBlbnRpdHlLZXksIHZhcmlhYmxlcywgZ2V0QnJlYWRjcnVtYnMgfSA9IG9wdGlvbnM7XHJcblxyXG4gICAgY29uc3QgYnJlYWRjcnVtYlN1YmplY3QkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxCcmVhZGNydW1iVmFsdWU+KG9wdGlvbnMuYnJlYWRjcnVtYiA/PyAnJyk7XHJcbiAgICBjb25zdCB0aXRsZVN1YmplY3QkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxzdHJpbmcgfCB1bmRlZmluZWQ+KG9wdGlvbnMudGl0bGUpO1xyXG5cclxuICAgIGNvbnN0IHJlc29sdmVGbjpcclxuICAgICAgICB8IFJlc29sdmVGbjx7XHJcbiAgICAgICAgICAgICAgZW50aXR5OiBPYnNlcnZhYmxlPFJlc3VsdE9mPFQ+W0ZpZWxkXSB8IG51bGw+O1xyXG4gICAgICAgICAgICAgIHJlc3VsdD86IFJlc3VsdE9mPFQ+O1xyXG4gICAgICAgICAgfT5cclxuICAgICAgICB8IHVuZGVmaW5lZCA9XHJcbiAgICAgICAgcXVlcnkgJiYgZW50aXR5S2V5XHJcbiAgICAgICAgICAgID8gY3JlYXRlQmFzZURldGFpbFJlc29sdmVGbih7XHJcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5LFxyXG4gICAgICAgICAgICAgICAgICBlbnRpdHlLZXksXHJcbiAgICAgICAgICAgICAgICAgIHZhcmlhYmxlcyxcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHBhdGg6IG9wdGlvbnMucGF0aCA/PyAnJyxcclxuICAgICAgICBwcm92aWRlcnM6IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcHJvdmlkZTogUk9VVEVfQ09NUE9ORU5UX09QVElPTlMsXHJcbiAgICAgICAgICAgICAgICB1c2VWYWx1ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudDogb3B0aW9ucy5jb21wb25lbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUkOiB0aXRsZVN1YmplY3QkLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFkY3J1bWIkOiBicmVhZGNydW1iU3ViamVjdCQsXHJcbiAgICAgICAgICAgICAgICB9IHNhdGlzZmllcyBSb3V0ZUNvbXBvbmVudE9wdGlvbnMsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIC4uLihvcHRpb25zLnJvdXRlQ29uZmlnPy5wcm92aWRlcnMgPz8gW10pLFxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgLi4uKG9wdGlvbnMucm91dGVDb25maWcgPz8ge30pLFxyXG4gICAgICAgIHJlc29sdmU6IHsgLi4uKHJlc29sdmVGbiA/IHsgZGV0YWlsOiByZXNvbHZlRm4gfSA6IHt9KSwgLi4uKG9wdGlvbnMucm91dGVDb25maWc/LnJlc29sdmUgPz8ge30pIH0sXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICBicmVhZGNydW1iOiBicmVhZGNydW1iU3ViamVjdCQsXHJcbiAgICAgICAgICAgIC4uLihvcHRpb25zLnJvdXRlQ29uZmlnPy5kYXRhID8/IHt9KSxcclxuICAgICAgICAgICAgLi4uKGdldEJyZWFkY3J1bWJzXHJcbiAgICAgICAgICAgICAgICA/IHtcclxuICAgICAgICAgICAgICAgICAgICAgIGJyZWFkY3J1bWI6IGRhdGEgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmRldGFpbC5lbnRpdHkucGlwZShtYXAoKGVudGl0eTogYW55KSA9PiBnZXRCcmVhZGNydW1icyhlbnRpdHkpKSksXHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIDoge30pLFxyXG4gICAgICAgICAgICAuLi4ob3B0aW9ucy5yb3V0ZUNvbmZpZz8uZGF0YSA/PyB7fSksXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb21wb25lbnQ6IEFuZ3VsYXJSb3V0ZUNvbXBvbmVudCxcclxuICAgIH0gc2F0aXNmaWVzIFJvdXRlO1xyXG59XHJcbiJdfQ==